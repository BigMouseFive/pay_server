# pay_server

## 1. 需求分析
- 扫码支付
- 获取更新代码
- 验证权限和日期

## 2. 节点详细说明
### 2.1. 扫码支付
#### 2.1.1. 流程
- 客户端请求付款码（购买的时间和店铺数量、机器的序列号）
- 返回二维码
- 用户完成支付后：1.服务端等待异步通知反馈；2.客户端轮询请求付款结果。
- 付款成功：1.服务端将数据落库；2.客户端收到付款成功反馈。
- 付款失败：客户端收到付款失败反馈。

### 2.2. 获取更新代码
#### 2.2.1 流程
- 客户端请求获取最新版本号，并与本地版本对比
- 客户端发起更新请求，获取新版本，保存在本地
- 关闭客户端并执行更新包安装

### 2.3 验证权限和日期
#### 2.3.1
- 客户端请求验证权限和日期（机器的序列号， 当前店铺信息）
- 服务端读取数据库信息对比并反馈结果

## 3. 架构设计
### 3.1. 结构层次
- 接口层：tornado(python)
- 逻辑层: python
- 数据层: sqlite3(python)
- *可视化层